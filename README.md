# Task Comments API

## Описание
Это модуль `REST API` для `CRM` системы, который обрабатывает комментарии к задачам. Он построен с использованием `NestJS`, `TypeORM`, `PostgreSQL` и `TypeScript`.

## Инструкции по запуску

### Предварительные требования
- `Docker` и `Docker Compose`

### Шаги
1. Клонируйте репозиторий.
2. Запустите `docker-compose up --build`, чтобы собрать и запустить приложение и базу данных.

`API` будет доступен по адресу `http://localhost:3000`.
Документация `Swagger` доступна по адресу `http://localhost:3000/api`.

## Обоснование действий
- **Clean Architecture**: Проект структурирован с использованием принципов чистой архитектуры для разделения ответственности, что делает код более поддерживаемой и масштабируемой. Основная бизнес-логика изолирована.
- **Dependency Injection**: Используется во всем приложении для управления зависимостями и упрощению тестирования.
- **DTOs (Data Transfer Objects)**: Реализованы для определения формы данных, отправляемых по сети, и для выполнения валидации с использованием `class-validator`, обеспечивая целостность данных до того, как они попадут в бизнес-логику.
- **JWT Strategy**: Применяется для аутентификации без сохранения состояния. Также есть механизм `refresh token` для повышения безопасности и улучшения пользовательского опыта.
- **SOLID Principles**: Применены для обеспечения того, чтобы классы и модули имели единственную ответственность.

## Endpoints
- `POST /users`: Создать пользователя (`User`)
- `GET /users/:id`: Получить список пользователей по `ID`
- `GET /users/`: Получить список всех пользователей
- `PATCH /users/:id`: Редактировать пользователя
- `DELETE /users/:id`: Удалить пользователя
- `POST /auth/login`: Войти в систему для получения `JWT token`
- `POST /tasks`: Создать задачу (`Task`) (Только `User`)
- `GET /tasks`: Получить список всех задач
- `GET /tasks/:id`: Получить задачу по `ID`
- `PATCH /tasks/:id`: Редактировать задачу (Только владелец)
- `DELETE /tasks/:id`: Удалить задачу (Только владелец)
- `POST /comments`: Создать комментарий (`Comment`) (Только `Author`)
- `GET /comments?task_id=...`: Получить комментарии для задачи
- `GET /comments/:id`: Получить комментарий по `ID`
- `PATCH /comments/:id`: Обновить комментарий (Только владелец)
- `DELETE /comments/:id`: Удалить комментарий (Только владелец)

## Бизнес-правила
- Только пользователь может редактировать или удалять комментарий.
- Текст комментария обязателен (1-1000 символов).
- Комментарии возвращаются отсортированными по дате (сначала новые).
- Только автор (`Author`) может создать комментарий.
- Только пользователь (`User`) может создать задачу.
- Только пользователь задачи может редактировать или удалять ее.
- Задачи возвращаются отсортированными по дате (сначала новые).
- Каждая задача может иметь несколько комментариев, и комментарий может быть связан только с одной задачей.
